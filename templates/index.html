<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Height Warning</title>    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
    <script type="module" src="{{ url_for('static', filename='js/scripts.js') }}"></script>
    <script src="https://cdn.socket.io/4.6.1/socket.io.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
    integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

    <div class="container-fluid dashboard">
        <div class="row">
            <div class="col-12 bg-dark text-white text-center py-3">
                <h1>無人機即時監控系統</h1>
            </div>
        </div>

        <div class="row mt-3">
            <!-- 速度儀表 -->
            <div class="col-md-4">
                <div class="card speed-card h-100">
                    <div class="card-header text-white">
                        <h3 class="card-title mb-0">飛行速度</h3>
                    </div>
                    <div class="card-body d-flex flex-column align-items-center justify-content-center">
                        <div class="speedometer-container">
                            <svg viewBox="0 0 200 100" class="speedometer-svg">
                                <path class="speedometer-arc" d="M20 100 A80 80 0 0 1 180 100" fill="none" stroke="#e0e0e0" stroke-width="10"/>
                                <path id="speed-progress" class="speedometer-arc" d="M20 100 A80 80 0 0 1 20 100" fill="none" stroke="#28a745" stroke-width="10"/>
                                <line id="speed-needle" x1="100" y1="100" x2="20" y2="100" stroke="red" stroke-width="3"/>
                            </svg>
                            <div class="speedometer-label">
                                <span id="percentage" class="speed-value">0</span>
                                <span class="speed-unit">%</span>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer bg-light text-center">
                        <div class="row">
                            <div class="col">
                                <small class="text-muted">最小速度</small>
                                <div class="font-weight-bold">0%</div>
                            </div>
                            <div class="col">
                                <small class="text-muted">當前速度</small>
                                <div id="current-speed" class="font-weight-bold">0%</div>
                            </div>
                            <div class="col">
                                <small class="text-muted">最大速度</small>
                                <div class="font-weight-bold">100%</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 高度指示器 -->
            <div class="col-md-4">
                <div class="card height-card">
                    <div class="card-header">
                        <h3>飛行高度</h3>
                    </div>
                    <div class="card-body text-center">
                        <div class="height-container">
                            <div id="height-bar" class="height-bar"></div>
                            <div id="height-value" class="height-value">0公尺</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 電池狀態 -->
            <div class="col-md-4">
                <div class="card battery-card">
                    <div class="card-header">
                        <h3>電池資訊</h3>
                    </div>
                    <div class="card-body text-center">
                        <svg width="200" height="200" viewBox="0 0 100 100">
                            <circle cx="50" cy="50" r="45" fill="none" stroke="#e0e0e0" stroke-width="10" />
                            <circle id="battery-progress-circle" cx="50" cy="50" r="45" fill="none" stroke="green" 
                                    stroke-width="10" stroke-dasharray="339.2" stroke-dashoffset="339.2" transform="rotate(-90 50 50)" />
                        </svg>
                        <div class="battery-info">
                            <div id="battery-percent" class="battery-percent">100%</div>
                            <div id="battery-volt" class="battery-detail">Volt: 16.8V</div>
                            <div id="battery-current" class="battery-detail">Current: 1A</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mt-3">
            <!-- 飛行狀態 -->
            <div class="col-md-6">
                <div class="card status-card h-100">
                    <div class="card-header">
                        <h3>飛行狀態</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-6">
                                <div class="status-group">
                                    <h5>基本狀態</h5>
                                    <div class="status-item">
                                        <span>飛行模式:</span>
                                        <span id="flight-mode" class="flight-mode">未知</span>
                                    </div>
                                    <div class="status-item">
                                        <span>RTK狀態:</span>
                                        <span id="rtk-status" class="rtk-status">未知</span>
                                    </div>
                                    <div class="status-item">
                                        <span>解鎖狀態:</span>
                                        <span id="arming-status" class="arming-status">未知</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="status-group">
                                    <h5>姿態角度</h5>
                                    <div class="status-item">
                                        <span>Pitch:</span>
                                        <span id="pitch-angle">0°</span>
                                    </div>
                                    <div class="status-item">
                                        <span>Yaw:</span>
                                        <span id="yaw-angle">0°</span>
                                    </div>
                                    <div class="status-item">
                                        <span>Roll:</span>
                                        <span id="roll-angle">0°</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        
            <!-- 地圖 -->
            <div class="col-md-6">
                <div class="card map-card h-100">
                    <div class="card-header">
                        <h3>無人機位置</h3>
                    </div>
                    <div class="card-body">
                        <div id="map" class="map-container"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row mt-3">
            <!-- 充電圖表 -->
            <div class="col-md-12">
                <div class="card charging-card ">
                    <div class="card-header">
                        <h3>充電歷程</h3>
                    </div>
                    <div class="card-body">
                        <canvas id="chargingChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

    </div>
</body>
</html>